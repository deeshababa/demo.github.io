"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[19],{9019:function(e,r,n){n.d(r,{l:function(){return h}});var t=n(7294),u=n(7598),i=n(131);var o={},a=["children","errors","infos","messages","onChange","onReset","onSubmit","onValidate","validate","value"];function c(){return c=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},c.apply(this,arguments)}var f={},s={},v={errors:{},infos:{}},l=function(e){var r=null==e?void 0:e.match(/^(.+)\[([0-9]+)\]\.(.*)$/);if(r){var n=r[1];return{indexOfArray:r[2],arrayName:n,arrayObjName:r[3]}}},d=function(e,r){var n=l(e);if(n){var t,u=n.indexOfArray,i=n.arrayName,o=n.arrayObjName,a=null==(t=r[i])?void 0:t[u];return o?null==a?void 0:a[o]:a}return r[e]},m=function(e,r,n){var t=c({},n),u=l(e);if(u){var i,o=u.indexOfArray,a=u.arrayName,f=u.arrayObjName;if(t[a]||(t[a]=[]),f)t[a][o]||(t[a][o]=((i={})[f]=r,i)),t[a][o][f]=r;else t[a][o]=r}else t[e]=r;return t},y=function(e,r,n,t,u){var i;return"function"===typeof e?i=e(r,n):e.regexp&&(e.regexp.test(r)||(i=e.message||t({id:"form.invalid",messages:u}),e.status&&(i={message:i,status:e.status}))),i},b=function(e,r){return function(n,t,u,i){var o,a=d(n,t);return r&&(void 0===a||""===a||!1===a||Array.isArray(a)&&!a.length)?o=u({id:"form.required",messages:i}):e&&(Array.isArray(e)?e.some((function(e){return!!(o=y(e,a,t,u,i))})):o=y(e,a,t,u,i)),o}},g=function(e,r,n,t,u){var i={},o={};return e.forEach((function(e){var a,c=e[0],f=e[1],s=f.field,v=f.input;u||(i[c]=void 0,o[c]=void 0),v&&(a=v(c,r,n,t)),s&&!a&&(a=s(c,r,n,t)),"object"===typeof a?"info"===a.status?o[c]=a.message:i[c]=a.message||a:"string"===typeof a&&(i[c]=a)})),[i,o]},h=(0,t.forwardRef)((function(e,r){var n=e.children,o=e.errors,y=void 0===o?v.errors:o,h=e.infos,p=void 0===h?v.infos:h,O=e.messages,j=e.onChange,E=e.onReset,k=e.onSubmit,N=e.onValidate,A=e.validate,S=void 0===A?"submit":A,x=e.value,C=function(e,r){if(null==e)return{};var n,t,u={},i=Object.keys(e);for(t=0;t<i.length;t++)n=i[t],r.indexOf(n)>=0||(u[n]=e[n]);return u}(e,a),R=(0,t.useContext)(u.E).format,F=(0,t.useState)(x||f),w=F[0],_=F[1],q=(0,t.useMemo)((function(){return x||w}),[x,w]),T=(0,t.useState)(s),V=T[0],M=T[1],P=(0,t.useState)({errors:y,infos:p}),B=P[0],D=P[1],I=(0,t.useRef)({}),$=(0,t.useState)("unmounted"),z=$[0],G=$[1];(0,t.useEffect)((function(){z?"mounting"===z&&G("mounted"):G("mounting")}),[z]);var H=(0,t.useState)(void 0),J=H[0],K=H[1],L=(0,t.useRef)({}),Q=(0,t.useRef)([]),U=(0,t.useCallback)((function(e){var r=!1;return r=Q.current.filter((function(e){return Object.keys(L.current).includes(e)})).every((function(e){return q[e]&&(""!==q[e]||!1!==q[e])})),Object.keys(e).length>0&&(r=!1),r}),[q]),W=function(e){var r=e;return Object.keys(r).filter((function(e){return!L.current[e]||void 0===r[e]})).forEach((function(e){return delete r[e]}))},X=(0,t.useCallback)((function(e){var r=g(e,q,R,O),n=r[0],t=r[1];D((function(e){var r=c({},e.errors,n),u=c({},e.infos,t);W(r),W(u);var i={errors:r,infos:u};return N&&N(c({},i,{valid:U(r)})),I.current=i,i}))}),[U,R,O,N,q]);(0,t.useEffect)((function(){var e=Object.entries(L.current);"mounted"!==z&&["blur","change"].includes(S)&&Object.keys(q).length>0&&0===Object.keys(V).length&&X(e.filter((function(e){var r=e[0];return q[r]})).filter((function(e){var r=e[0];return!(Array.isArray(q[r])&&0===q[r].length)})))}),[X,z,V,S,q]),(0,t.useEffect)((function(){var e=Object.entries(L.current),r=setTimeout((function(){J&&["blur","change"].includes(S)&&(X(e.filter((function(e){var r=e[0];return V[r]||J.includes(r)}))),K(void 0))}),120);return function(){return clearTimeout(r)}}),[X,J,V,S]),(0,t.useEffect)((function(){var e,r=Object.entries(L.current);null!=(e=I.current)&&e.errors&&Object.keys(I.current.errors).length>0&&X(r.filter((function(e){var r=e[0];return V[r]&&I.current.errors[r]})))}),[X,V]);var Y=(0,t.useMemo)((function(){return{useFormField:function(e){var r=e.error,n=e.info,u=e.name,i=e.required,o=e.disabled,a=e.validate,c=o?void 0:r||B.errors[u],f=n||B.infos[u];return(0,t.useEffect)((function(){var e=Q.current.indexOf(u);if(i?-1===e&&Q.current.push(u):-1!==e&&Q.current.splice(e,1),a||i)return L.current[u]||(L.current[u]={}),L.current[u].field=b(a,i),function(){return delete L.current[u].field}}),[c,u,i,a,o]),{error:c,info:f,inForm:!0,onBlur:"blur"===S?function(){return K(J?[].concat(J,[u]):[u])}:void 0,onChange:"change"===S?function(){return K(J?[].concat(J,[u]):[u])}:void 0}},useFormInput:function(e){var r=e.name,n=e.value,u=e.initialValue,i=e.validate,o=(0,t.useState)(u),a=o[0],f=o[1],s=r?d(r,q):void 0,v=(0,t.useRef)(!1);return(0,t.useEffect)((function(){r&&void 0!==n&&n!==s&&_((function(e){return m(r,n,e)}))}),[n,s,r]),(0,t.useEffect)((function(){return function(){v.current&&(v.current=!1,_((function(e){var n=c({},e),t=l(r);t?delete n[t.arrayName]:delete n[r];return n})))}}),[]),(0,t.useEffect)((function(){if(i)return L.current[r]||(L.current[r]={}),L.current[r].input=b(i),function(){return delete L.current[r].input}}),[i,r]),[void 0!==n?n:x&&r&&void 0!==s?s:void 0===s&&r?u:a,function(e){if(r){var n=c({},V);n[r]=!0,V[r]||M(n),r in q||(v.current=!0);var t=m(r,e,q);_(t),j&&j(t,{touched:n})}void 0!==u&&f(e)}]}}}),[j,J,V,S,B.errors,B.infos,q,x]);return t.createElement("form",c({ref:r},C,{onReset:function(e){if(K(void 0),x||(_(f),j&&j(f,{touched:s})),M(s),D(v),E){e.persist();var r=e;r.value=f,E(r)}},onSubmit:function(e){e.preventDefault(),K(void 0);var r=g(Object.entries(L.current),q,R,O,!0),n=r[0],t=r[1];if(D((function(){var e={errors:n,infos:t,valid:U(n)};return N&&N(e),I.current=e,e})),0===Object.keys(n).length&&k){e.persist();var u=e;u.value=q,u.touched=V,k(u)}}}),t.createElement(i.q.Provider,{value:Y},n))}));h.displayName="Form",h.propTypes=o}}]);